# -*- coding: utf-8 -*-
"""report_beauty_saloon.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1td5Ls5kJzlLiv9sl3vQOfZDMJWgLEm9o

# –ë—Ä–∏—Ñ

–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å —Å–∫–≤–æ–∑–Ω—É—é –∞–Ω–∞–ª–∏—Ç–∏–∫—É –¥–ª—è —Å–∞–ª–æ–Ω–∞ –∫—Ä–∞—Å–æ—Ç—ã. –£ —Å–∞–ª–æ–Ω–∞ –µ—Å—Ç—å —Ä–µ–∫–ª–∞–º–∞ –≤ –æ–Ω–ª–∞–π–Ω–µ –∏ —Å–∞–π—Ç, —á–µ—Ä–µ–∑ –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É –Ω–∞ —É—Å–ª—É–≥—É. 

# –ó–∞–¥–∞—á–∞

–ù—É–∂–Ω–æ –ø—Ä–æ—Å–ª–µ–¥–∏—Ç—å –ø—É—Ç—å –æ—Ç –∫–ª–∏–∫–∞ –ø–æ —Ä–µ–∫–ª–∞–º–Ω–æ–º—É –æ–±—ä—è–≤–ª–µ–Ω–∏—é –¥–æ –ø–æ–∫—É–ø–∫–∏ –∏, —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –æ—Ü–µ–Ω–∏—Ç—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–∞. 

> –ö–ª–∏–∫ –ø–æ —Ä–µ–∫–ª–∞–º–µ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –≤ –ª–∏–¥ (–∑–∞—è–≤–∫—É), –∞ –ª–∏–¥ –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ –∫–ª–∏–µ–Ω—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π —É–∂–µ –º–æ–∂–µ—Ç —Å–æ–≤–µ—Ä—à–∏—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–∫—É–ø–æ–∫.

# üìö 1. –ò–º–ø–æ—Ä—Ç
"""

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
import warnings

warnings.filterwarnings("ignore")

"""# üõí 2. –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞

https://drive.google.com/file/d/1h87CdXJ9A6gVeKA_HfSHnyDsAoDRxjKM/view?usp=sharing - ads

https://drive.google.com/file/d/168k12wl3eVbX7gX2vIVLoPZ76KuwT-VS/view?usp=sharing - purcahse

https://drive.google.com/file/d/1jlH-sawHyBgB7CEuSJjfOeubncOg8Ks9/view?usp=sharing - leads
"""

!gdown 1h87CdXJ9A6gVeKA_HfSHnyDsAoDRxjKM
!gdown 168k12wl3eVbX7gX2vIVLoPZ76KuwT-VS
!gdown 1jlH-sawHyBgB7CEuSJjfOeubncOg8Ks9

ads = pd.read_csv('/content/ads.csv')

ads.head()

ads.info()

"""- 8 —Å—Ç–æ–ª–±—Ü–æ–≤
- 8602 —Å—Ç—Ä–æ–∫–∏
- –ø—É—Å—Ç–æ–π —Å—Ç–æ–ª–±–µ—Ü d_utm_term
- —Å—Ç–æ–ª–±–µ—Ü created_at –Ω–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç 
"""

leads = pd.read_csv('/content/leads.csv')

leads.head()

leads.info()

"""- 8 —Å—Ç–æ–ª–±—Ü–æ–≤
- 23540 —Å—Ç—Ä–æ–∫–∏
- –ø—Ä–æ–ø—É—Å–∫–∏ –≤ d_lead_utm_source d_lead_utm_medium d_lead_utm_campaign d_lead_utm_content d_lead_utm_term client_id
- —Å—Ç–æ–ª–±–µ—Ü lead_created_at –Ω–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç 
"""

purch = pd.read_csv('/content/purchases.csv')

purch.head()

purch.info()

"""- 4 —Å—Ç–æ–ª–±—Üa
- 66180 —Å—Ç—Ä–æ–∫
- –ø—Ä–æ–ø—É—Å–∫–∏ –≤ client_id
- —Å—Ç–æ–ª–±–µ—Ü purchase_created_at –Ω–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç

# üí° 3. –û–ø–∏—Å–∞–Ω–∏–µ –∏ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
"""

ads['d_utm_source'].unique()

"""- –∏—Å—Ç–æ—á–Ω–∏–∫ —Ä–µ–∫–ª–∞–º—ã —Ç–æ–ª—å–∫–æ —è–Ω–¥–µ–∫—Å, –∑–Ω–∞—á–∏—Ç –≤ —Ç–∞–±–ª–∏—Ü–µ leads –±—É–¥–µ–º –∏—Å–∫–∞—Ç—å —Ç–æ–ª—å–∫–æ –µ–≥–æ"""

ads['d_utm_medium'].unique()

"""- cpc, –≤ —Ç–∞–±–ª–∏—Ü–µ leads –∏—â–µ–º —Ç–æ–ª—å–∫–æ  cpc"""

# –Ω–æ–º–µ—Ä–∞ —Ä–µ–∫–ª–∞–º–Ω—ã—Ö –∫–æ–º–ø–∞–Ω–∏–π
ads['d_utm_campaign'].unique()

# –ø–æ –≤–∏–¥–∏–º–æ–º—É –Ω–æ–º–µ—Ä–∞ —Ä–µ–∫–ª–∞–º–Ω—ã—Ö –æ–±—ä—è–≤–ª–µ–Ω–∏–π
ads['d_utm_content'].unique()

# —É–¥–∞–ª—è–µ–º –ø—É—Å—Ç–æ–π —Å—Ç–æ–±–µ—Ü ads
ads = ads.drop('d_utm_term', axis=1)

# —É–¥–∞–ª—è–µ–º –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–π —Å—Ç–æ–±–µ—Ü leads
leads = leads.drop('d_lead_utm_term', axis=1)

# –¥–µ–ª–∞–µ–º –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è –∫–æ–ª–æ–Ω–æ–∫ –¥–ª—è –¥–≤—É—Ö —Ç–∞–±–ª–∏—Ü—ã
leads.columns = ['created_at', 'lead_id', 'utm_source', 'utm_medium',
       'utm_campaign', 'utm_content', 'client_id']

# –¥–µ–ª–∞–µ–º –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è –∫–æ–ª–æ–Ω–æ–∫ –¥–ª—è –¥–≤—É—Ö —Ç–∞–±–ª–∏—Ü—ã
ads.columns = ['created_at', 'ad_account_id', 'utm_source', 'utm_medium',
       'utm_campaign', 'utm_content', 'm_clicks', 'm_cost']

ads.info()

leads.info()

ads['utm_campaign'].unique()

leads['utm_campaign'].unique()

"""- –≤ —Ç–∞–±–ª–∏—Ü–µ ads utm_campaign –∏ utm_content –∏–º–µ—é—Ç —Ñ–æ—Ä–º–∞—Ç int, –≤ —Ç–∞–±–ª–∏—Ü–µ leads —Ñ–æ—Ä–º–∞—Ç —ç—Ç–∏—Ö —Å—Ç–æ–ª–±—Ü–æ–≤ object. –í—ã–¥–µ–ª–∏–º –∏–∑ —Ç–∞–±–ª–∏—Ü—ã leads —Ç–æ–ª—å–∫–æ —á–∏—Å–ª–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è. """

# –æ—Å—Ç–∞–ª–≤—è–µ–º —Ç–æ–ª—å–∫–æ —á–∏—Å–ª–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ, –º–µ–Ω—è–µ–º —Ç–∏–ø
leads['utm_campaign'] = leads['utm_campaign'].str.extract('(\d+)').dropna().astype(int)

# –æ—Å—Ç–∞–ª–≤—è–µ–º —Ç–æ–ª—å–∫–æ —á–∏—Å–ª–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ, –º–µ–Ω—è–µ–º —Ç–∏–ø
leads['utm_content'] = leads['utm_content'].str.extract('(\d+)').dropna().astype(int)

"""# üìë 4. –°–æ–∑–¥–∞–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã

- —Å–æ–µ–¥–µ–Ω–µ–Ω–∏—è ads –∏ leads –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ 5 –∏–∑ 6 —Å—Ç–æ–ª–±—Ü–∞–º, —Ç–∞–∫ –∫–∞–∫ –æ–¥–∏–Ω —Å—Ç–æ–ª–±–µ—Ü –±—ã–ª –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø—É—Å—Ç–æ–π.
- —Å–æ–µ–¥–µ–Ω—è–µ–º —Å –ø–æ–º–æ—â—å—é left —á—Ç–æ–±—ã –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ —Ç–∞–±–ª–∏—Ü—ã ads –æ—Å—Ç–∞–ª–∏—Å—å
"""

df = (ads.merge(leads, 
             on=['created_at', 'utm_source', 'utm_medium', 'utm_campaign', 'utm_content'], 
             how='left')
      )

df.head()

df = df.merge(purch, on='client_id', how='left')

df.head()

df.info()

"""- –ø–æ—Å–ª–µ —Å–æ–µ–¥–µ–Ω–µ–Ω–∏—è –≤–∏–¥–Ω–æ —á—Ç–æ –∫–ª–∏–µ–Ω—Ç–æ–≤ –ø—Ä–∏—Å–æ–µ–¥–µ–Ω–∏–ª–æ—Å—å 2162, –º–æ–≥—É –ø—Ä–µ–¥–ø–æ–ª–æ–∂–∏—Ç—å —á—Ç–æ –æ—Å—Ç–∞–ª—å–Ω–∞—è —Ä–µ–∫–ª–∞–º–∞ –∏–∑ ads –∫–ª–∏–µ–Ω—Ç–æ–≤ –Ω–µ –ø—Ä–∏–Ω–µ—Å–ª–∞ –∏–ª–∏ —Å–∏—Å—Ç–µ–º–∞ –Ω–µ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–ª–∞.

## 4.1 –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
"""

# –¥–∞—Ç—É –≤ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç
df['purchase_created_at'] = pd.to_datetime(df['purchase_created_at'], format='%Y-%m-%d')
df['created_at'] = pd.to_datetime(df['created_at'], format='%Y-%m-%d')

"""## 4.2 –ü–æ–∏—Å–∫ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤"""

# –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —è–≤–Ω—ã–µ –¥—É–±–ª–∏–∫–∞—Ç—ã
df.duplicated().sum()

"""- –µ—Å–ª–∏ –ø—Ä–µ–¥–ø–æ–ª–æ–∂–∏—Ç—å —á—Ç–æ –Ω–∞ –∫–∞–∂–æ–≥–æ —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å id —É–Ω–∏–∫–∞–ª—å–Ω–æ–π –ø–æ–∫—É–ø–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä –∫–æ–≥–¥–∞ –ø–æ–∫—É–ø–∞—Ç–µ–ª—å –ø—Ä–∏—Ö–æ–¥–∏—Ç –≤ —Å–∞–ª–æ–Ω –∫—Ä–∞—Å–æ—Ç—ã –∏ –¥–µ–ª–∞–µ—Ç —Å—Ç—Ä–∏–∂–∫—É, –ø–æ–ª—É—á–∞–µ—Ç —á–µ–∫ —Å –Ω–æ–º–µ—Ä–æ–º, –∑–∞—Ç–µ–º –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –∏ –ø–æ–∫—É–ø–∞–µ—Ç –∫—Ä–∞—Å–∫—É –¥–ª—è –≤–æ–ª–æ–º –∏ –ø–æ–ª—É—á–∞–µ—Ç—Å—è –µ—â–µ –æ–¥–∏–Ω —á–µ–∫ —Å –¥—Ä—É–≥–∏–º –Ω–æ–º–µ—Ä–æ–º, –æ–¥–∏–Ω–∞–∫–æ–≤–æ–≥–æ –Ω–æ–º–µ—Ä–∞ —á–µ–∫–∞ –±—ã—Ç—å –Ω–µ –º–æ–∂–µ—Ç)"""

df.duplicated(subset=['client_id', 'purchase_id']).sum()

df[df.duplicated(subset=['client_id', 'purchase_id'])].head(2)

# —É–¥–∞–ª—è–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã –≥–¥–µ –æ–¥–∏–Ω –∫–ª–∏–µ–Ω –Ω–æ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ id –ø–æ–∫—É–ø–∫–∏
df = df.drop_duplicates(subset=['client_id', 'purchase_id'])

"""- –ø–æ—Å–º–æ—Ç—Ä–∏–º –µ—Å—Ç—å –ª–∏ –ª–∏–¥—ã –∏ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ —á–µ–∫–∏"""

df.duplicated(subset=['lead_id', 'purchase_id']).sum()

"""- —Ç–∞–∫ –∂–µ –º–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –µ—Å—Ç—å –ª–∏ –ø–æ–∫—É–ø–∫–∏ –ø–æ –æ–¥–Ω–æ–º—É —á–µ–∫—É, –≥–¥–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–ª–∏–µ–Ω—Ç–æ–≤"""

df.groupby('purchase_id')['client_id'].nunique().reset_index().query('client_id > 1')

df.head()

df.info()

"""## 4.3 –ü–æ–∏—Å–∫ –∞–Ω–æ–º–∞–ª–∏–π"""

df.describe()

cat_columns = df[['m_clicks', 'm_cost', 'm_purchase_amount']]


plt.figure(figsize=(16,5))
for i, column in enumerate(sorted(cat_columns)):
    plt.subplot(1,3,i+1)
    plt.title(column)
    sns.histplot(df, x=column, discrete=False, alpha=0.7, bins=10)
    plt.legend([column])
    plt.xticks(rotation=0,
      horizontalalignment='right',
      fontweight='light',
      fontsize='medium',)
plt.show()

"""- –≤ —Ü–µ–ª–æ–º –¥–∞–Ω–Ω—ã–µ –≤—ã–≥—è–ª–¥—è—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ, –Ω–µ—Ç –∫–∞–∫–∏—Ö —Ç–æ –∞–Ω–æ–º–∞–ª—å–Ω—ã—Ö –∏–ª–∏ –º–∏–Ω—É—Å–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.

# 4.4 –ê—Ç—Ä–∏–±—É—Ü–∏—è –ª–∏–¥ - –ø–æ–∫—É–ø–∫–∞

> –ö–∞–∂–¥–æ–º—É –ª–∏–¥—É ‚Äú–≤ –∑–∞—á–µ—Ç‚Äù –∏–¥—É—Ç —Ç–æ–ª—å–∫–æ —Ç–µ –ø–æ–∫—É–ø–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –∫–ª–∏–µ–Ω—Ç —Å–¥–µ–ª–∞–ª –≤ –ø–µ—Ä–≤—ã–µ 15 –¥–Ω–µ–π –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞—è–≤–∫–∏. –ò–∑-–∑–∞ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –±–∏–∑–Ω–µ—Å–∞ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –ª–∏–¥–æ–≤ –∏ –ø—Ä–æ–¥–∞–∂ - –º–Ω–æ–≥–∏–µ –∫–æ –º–Ω–æ–≥–∏–º. –°—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–ª–∏–µ–Ω—Ç –º–æ–∂–µ—Ç –∫—É–ø–∏—Ç—å —É—Å–ª—É–≥—É –ø–æ–≤—Ç–æ—Ä–Ω–æ —á–µ—Ä–µ–∑ –∑–∞–≤–µ–¥–µ–Ω–∏–µ –Ω–æ–≤–æ–π –∑–∞—è–≤–∫–∏, –∞ –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞—Ç—å –¥–≤–µ –∑–∞—è–≤–∫–∏ –ø–æ–¥—Ä—è–¥ –∏ –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ —Å–¥–µ–ª–∞—Ç—å –ø–æ–∫—É–ø–∫—É.
"""

df.info()

# —Å—á–∏—Ç–∞–µ–º —Ä–∞–∑–Ω–∏—Ü—É –¥–Ω–µ–π
df['datediff'] = (df['purchase_created_at'] - df['created_at']).dt.days

# —Ñ–∏–ª—å—Ç—Ä –ø–æ —É—Å–ª–æ–≤–∏—é
df = df.query('datediff <= 15')

"""- –æ–±—Ä–∞—Ç–∏ –≤–Ω–∏–º–∞–Ω–∏–µ, –∫–æ–≥–¥–∞ –¥–µ–ª–∞–µ–º —Ñ–∏–ª—å—Ç—Ä, –≤—Å–µ –ø—É—Å—Ç—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏—Å–∫–ª—é—á–∞—Ç—Å—è —Ç–∞–∫ –∫–∞–∫ –º—ã –Ω–µ –º–æ–∂–µ–º –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å —Ç–∞–∫–∏–µ –ø–æ–∫—É–ø–∫–∏ –ø–æ —É—Å–ª–æ–≤–∏—é."""

df.head()

"""- –≤ —Ç–∞–±–ª–∏—Ü–µ –≤–∏–¥–∏–º –º–∏–Ω—É—Å–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–∞—Ç, –¥—É–º–∞—é —á—Ç–æ —ç—Ç–æ —Å—Ç–∞—Ä—ã–µ –∫–ª–∏–µ–Ω—Ç—ã –∫–æ—Ç–æ—Ä—ã –ø–æ–∫—É–ø–∞–ª–∏ —É–∂–µ —Ä–∞–Ω–µ–µ, –Ω–æ –ø–æ—Ç–æ–º –Ω–µ–∫–æ—Ä—ã–µ –∏–∑ –Ω–∏—Ö –ø—Ä–∏–≥–ª–∏ –ø–æ —Ä–µ–∫–ª–∞–º–µ. –¢–∞–∫ –∏–ª–∏ –∏–Ω–∞—á–µ –æ–Ω–∏ –Ω–µ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—è—é—Ç —É—Å–ª–æ–≤–∏—è–º –∑–∞–¥–∞—á–∏."""

df = df.query('0 <= datediff <= 15')

df.info()

df.describe()

"""- –≤ —Ç–∞–±–∏–ª—Ü–µ –µ—Å—Ç—å 0 –∑–Ω–∞—á–µ–Ω–∏–π –ø–æ –≤—ã—Ä—É—á–∫–µ, –≤–æ–∑–º–æ–∂–Ω–æ –æ–ø–ª–∞—Ç–∞ –±—ã–ª–∞ –±–æ–Ω—É—Å–∞–º–∏ –∏–ª–∏ –∫–∞–∫–∏–º —Ç–æ –µ—â–µ —Å–ø–æ—Å–æ–±–æ–º. –°—á–∏—Ç–∞—é —á—Ç–æ —É–¥–∞–ª—è—Ç—å —Ç–∞–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –Ω–µ —Å—Ç–æ–∏—Ç. 
- –µ—Å—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è —Å 0 –∫–ª–∏–∫–æ–≤, –≤–æ–∑–º–æ–∂–Ω–æ —ç—Ç–æ —Ç–µ—Ö —Å–±–æ–π, —Ä–µ–∫–ª–∞–º–∞ –≤ –Ω–∏—Ö —Ä–∞–≤–Ω–∞ 0. –°—Ç–æ–∏—Ç –ª–∏ –∏—Ö —É–¥–∞–ª—è—Ç—å? –Ø –Ω–µ –∑–Ω–∞—é, –ø–æ—ç—Ç–æ–º—É –æ—Å—Ç–∞–≤–ª—é.
"""

df.query('m_clicks == 0')

"""# üßÆ 5. –ò—Ç–æ–≥–æ–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç"""

# —Ä–∞—Å—Ö–æ–¥ –Ω–∞ —Ä–µ–∫–ª–∞–º—É
df['adv_spend'] = df['m_cost'] * df['m_clicks']

# cpl
df['cpl'] = df['adv_spend'] / df['lead_id'].count()

# roas
df['roas'] = df['m_purchase_amount'] / df['adv_spend']

# –∑–∞–≥–ª—É—à–∫–∏ —á—Ç–æ–±—ã –ø–æ—Å—á–∏—Ç–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–ª—è –æ—Ç—á–µ—Ç–∞
df['cnt_lead'] = 1
df['cnt_purchase'] = 1

# —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –ø–æ —É—Å–ª–æ–≤–∏—è–º —Ç–µ—Ö –∑–∞–¥–∞–Ω–∏—è
report = df[['created_at', 'utm_source', 'utm_medium', 'utm_campaign', 'm_clicks', 'adv_spend', 'cnt_lead', 'cnt_purchase', 'm_purchase_amount', 'cpl', 'roas']]

report = report.rename(columns={'created_at': '–î–∞—Ç–∞', 
                       'utm_source': 'UTM source',
                       'utm_medium': 'UTM medium',
                       'utm_campaign': 'UTM campaign',
                       'm_clicks': '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∏–∫–æ–≤',
                       'adv_spend': '–†–∞—Å—Ö–æ–¥—ã –Ω–∞ —Ä–µ–∫–ª–∞–º—É',
                       'cnt_lead': '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª–∏–¥–æ–≤',
                       'cnt_purchase': '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–∫—É–ø–æ–∫',
                       'm_purchase_amount': '–í—ã—Ä—É—á–∫–∞ –æ—Ç –ø—Ä–æ–¥–∞–∂',
                       'cpl': 'CPL',
                       'roas': 'ROAS'})

report = report.sort_values(by='–î–∞—Ç–∞')

report.head()

report.to_excel('report.xlsx')

"""üôÇ –°–ø–∞—Å–∏–±–æ –∑–∞ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–µ —Ç–µ—Å—Ç–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ! """